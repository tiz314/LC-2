; MULT2
	.ORIG	x3000

	LEA	R0,ARRAY
	JSR	MULT2
END	BRNZP	END

ARRAY	.FILL	32000
	.FILL	-32000
	.FILL	-3
	.FILL	0

; Utilizzo registri
; Input R0: indirizzo array
; R1: elemento caricato
; R2: somma

MULT2	BRNZP	BACKUP
INIZIO	LDR	R1,R0,#0
	BRZ	RESTORE
	ADD	R2,R1,#0
	ADD	R2,R2,R1
	ADD	R1,R1,#0
	BRP	A_P
	BRN	A_N
CONT	STR	R2,R0,#0
	ADD	R0,R0,#1
	BRNZP	INIZIO

A_P	ADD	R2,R2,#0
	BRZP	CONT
	LD	R2,MAX
	BRNZP	CONT

A_N	ADD	R2,R2,#0
	BRNZ	CONT
	LD	R2,MIN
	BRNZP	CONT


BACKUP	ST	R1,BK1
	ST	R2,BK2
	BRNZP	INIZIO	


RESTORE	LD	R1,BK1
	LD	R2,BK2
	RET


BK1	.BLKW	1
BK2	.BLKW	1

MAX	.FILL	32767
MIN	.FILL	-32768

	.END