; Conta numero di caratteri alfabeticamente maggiori o minori
	.ORIG	x3000
	LEA	R0,A
	LD	R1,LETT
	JSR	CONTA_PREC_SEG
END	BRNZP	END

A	.STRINGZ	""
LETT	.FILL		77
; inizio subp

CONTA_PREC_SEG
	ST	R2,BK2
	ST	R3,BK3
	ST	R4,BK4
	ST	R5,BK5
	
	AND	R3,R3,#0	
	AND	R4,R4,#0
	
CHECK	LDR	R2,R0,#0
	BRZ	FINE

	LD	R5,MIN_C
	ADD	R5,R5,R2
	BRZP	MIN
; qui carattere maiuscolo
	NOT	R2,R2
	ADD	R2,R2,#1
	ADD	R2,R2,R1
	BRN	SEG
	BRP	PREC
	BRNZP	CONT
	

MIN	LD	R5,SPACE
	ADD	R2,R1,R5
	LDR	R5,R0,#0
	NOT	R5,R5
	ADD	R5,R5,#1
	ADD	R5,R5,R2
	BRN	SEG
	BRP	PREC
	BRNZP	CONT


SEG	ADD	R4,R4,#1
	BRNZP	CONT

PREC	ADD	R3,R3,#1

CONT	ADD	R0,R0,#1
	BRNZP	CHECK


FINE	ADD	R0,R3,#0
	ADD	R1,R4,#0
	LD	R2,BK2
	LD	R3,BK3
	LD	R4,BK4
	LD	R5,BK5
	RET
	

BK2	.BLKW	1
BK3	.BLKW	1
BK4	.BLKW	1
BK5	.BLKW	1
SPACE	.FILL	#32
MIN_C	.FILL	#-97
; fine subp

	.END